---
import { getCollection } from "astro:content";
import BlogPostLayout from "../../layouts/BlogPostLayout.astro";
import BlogImage from "../../components/BlogImage.astro";

export async function getStaticPaths() {
  const posts = await getCollection("blog");

  return posts.map((post) => ({
    params: {
      slug: post.slug,
    },
    props: {
      post,
    },
  }));
}

const { data } = Astro.props.post;
const { Content } = await Astro.props.post.render();

// TODO: Move blog images to /src/assets when https://github.com/withastro/astro/issues/7223 is resolved
---

<BlogPostLayout
  title={data.title}
  abstract={data.abstract}
  published={data.published}
  updated={data.updated}
  relativePath={`/blog/${Astro.params.slug}`}
  backLinkPath="/blog"
>
  <Content components={{ img: BlogImage }} />
</BlogPostLayout>
